!function(e){"use strict";e.xmlViewerPlugin=class{constructor(e,t,n){this.containerId=e,this.container=document.getElementById(this.containerId),this.url=t,this.nodeLevelCounter=0,this.whiteCharsRegex=/\S/,this.numberOfNodesToShow=n,this.buttonIsKeyDown=!1,this.load()}load(){var e=new XMLHttpRequest;e.open("get",this.url,!0),e.responseType="document",e.overrideMimeType("text/xml"),e.onload=(()=>{e.readyState===e.DONE&&200===e.status&&(this.prepareXml(e.response),this.bindExpandChildNodesEvent())}),e.send()}prepareXml(e){this.nodeLevelCounter=0,this.nodeGlobalCounter=0,this.container.appendChild(this.prepareNode(e.documentElement))}createHTMLElement(e,t,n,i){const s=document.createElement(e);return t&&(s.className=t),n&&s.appendChild(document.createTextNode(n)),i&&(s.id=i),s}checkNodeIsNotEmpty(e){let t=0;return e.forEach(e=>{if(!this.whiteCharsRegex.test(e.textContent))return!1;t++}),t>0}shouldBeExpanded(){return this.nodeLevelCounter<=this.numberOfNodesToShow}prepareNode(e){const t=this.createHTMLElement("span","tag"),n=this.checkNodeIsNotEmpty(e.childNodes);if(this.nodeLevelCounter++,t.classList.add(n?"tag-nonempty":"tag-empty"),n&&t.appendChild(this.createToggleElement()),t.appendChild(this.prepareOpeningTag(e)),e.childNodes.length){const n=this.createHTMLElement("span","tag-content");this.shouldBeExpanded()?this.setVisibility(n,!0):this.setVisibility(n,!1),Array.from(e.childNodes).forEach(e=>{let t;(t=1===e.nodeType?this.prepareNode(e):8===e.nodeType?this.prepareCommentNode(e):this.prepareTextNode(e))&&n.appendChild(t)}),t.appendChild(n)}return this.nodeLevelCounter--,t.appendChild(this.prepareClosingTag(e)),t}createToggleElement(){const e=this,t=this.createHTMLElement("span","expand",!1);return this.shouldBeExpanded()&&t.classList.add("expanded"),t.appendChild(this.createHTMLElement("span","on","+")),t.appendChild(this.createHTMLElement("span","off","-")),t.onclick=function(){const t=this.classList.contains("expanded");e.buttonIsKeyDown?(e.setElementVisibility(this,!t),e.setVisibilityForChildElements(this.nextSibling.nextSibling,!t)):e.setElementVisibility(this,!t)},t}setElementVisibility(e,t){t?e.classList.contains("expanded")||(e.classList.add("expanded"),this.setVisibility(e.nextSibling.nextSibling,!0)):(e.classList.remove("expanded"),this.setVisibility(e.nextSibling.nextSibling,!1))}setVisibility(e,t){e.style.display=t?"block":"none"}prepareOpeningTag(e){const t=this.createHTMLElement("span","opening-tag");if(t.appendChild(this.createHTMLElement("span","opening","<")),t.appendChild(this.createHTMLElement("span","tag-name",e.tagName)),e.attributes.length){const n=this.createHTMLElement("span","attributes");Array.from(e.attributes).forEach(e=>{const t=this.createHTMLElement("span","attribute");t.appendChild(this.createHTMLElement("span","attribute-name"," "+e.name)),t.appendChild(this.createHTMLElement("span","attribute-equal-char","=")),t.appendChild(this.createHTMLElement("span","attribute-value",`"${e.value}"`)),n.appendChild(t)}),t.appendChild(n)}return t.appendChild(this.createHTMLElement("span","closing",">")),this.appendNumberTag(t),t}prepareClosingTag(e){const t=this.createHTMLElement("span","closing-tag");return t.appendChild(this.createHTMLElement("span","opening","</")),t.appendChild(this.createHTMLElement("span","tag-name",e.tagName)),t.appendChild(this.createHTMLElement("span","closing",">")),this.appendNumberTag(t),t}prepareTextNode(e){if(!this.whiteCharsRegex.test(e.textContent))return!1;const t=this.createHTMLElement("span","text-content",e.textContent);return this.appendNumberTag(t),t}prepareCommentNode(e){if(!this.whiteCharsRegex.test(e.textContent))return!1;const t=this.createHTMLElement("span","comment-content",`\x3c!--${e.textContent}--\x3e`);return this.appendNumberTag(t),t}prepareNumberTag(e){return this.createHTMLElement("span","line-number",e)}appendNumberTag(e){this.nodeGlobalCounter++,e.prepend(this.prepareNumberTag(this.nodeGlobalCounter))}bindExpandChildNodesEvent(){window.addEventListener("keydown",e=>{18===e.keyCode&&(this.buttonIsKeyDown=!0)}),window.addEventListener("keyup",e=>{18===e.keyCode&&(this.buttonIsKeyDown=!1)})}setVisibilityForChildElements(e,t){this.checkNodeIsNotEmpty(e.childNodes)&&Array.from(e.childNodes).forEach(e=>{if(e.classList.contains("tag-nonempty")&&e.firstChild.nextSibling.nextSibling){const n=e.firstChild;this.setElementVisibility(n,t),this.setVisibilityForChildElements(n.nextSibling.nextSibling,t)}})}}}(window);
!function(e){"use strict";const t=/\S/,n=1,i=3,s=8,a=18;e.xmlViewerPlugin=class{constructor(e,t,n,i){this.containerId=e,this.container=document.getElementById(this.containerId),this.url=t,this.nodeLevelCounter=0,this.numberOfNodesToShow=n,this.buttonIsKeyDown=!1,this.searchInputId=i,this.initializeSearch(),this.load()}load(){var e=new XMLHttpRequest;e.open("get",this.url,!0),e.responseType="document",e.overrideMimeType("text/xml"),e.onload=(()=>{e.readyState===e.DONE&&200===e.status&&(this.prepareXml(e.response),this.bindExpandChildNodesEvent())}),e.send()}prepareXml(e){this.nodeLevelCounter=0,this.nodeGlobalCounter=0,this.container.appendChild(this.prepareNode(e.documentElement))}createHTMLElement(e,t,n,i){const s=document.createElement(e);if(t&&(s.className=t),n){const t=document.createElement(e);t.className="text",t.appendChild(document.createTextNode(n)),s.appendChild(t)}return i&&(s.id=i),s}checkNodeIsNotEmpty(e){let n=0;return e.forEach(e=>{if(!t.test(e.textContent))return!1;n++}),n>0}shouldBeExpanded(){return this.nodeLevelCounter<=this.numberOfNodesToShow}prepareNode(e){const t=this.createHTMLElement("span","tag"),n=this.checkNodeIsNotEmpty(e.childNodes);if(this.nodeLevelCounter++,t.classList.add(n?"tag-nonempty":"tag-empty"),n&&t.appendChild(this.createToggleElement()),t.appendChild(this.prepareOpeningTag(e)),e.childNodes.length){const n=this.createHTMLElement("span","tag-content");this.setVisibility(n,this.shouldBeExpanded()),Array.from(e.childNodes).forEach(e=>this.chooseSpecificNodeToPrepare(e,n)),t.appendChild(n)}return this.nodeLevelCounter--,t.appendChild(this.prepareClosingTag(e)),t}chooseSpecificNodeToPrepare(e,t){let i;(i=e.nodeType===n?this.prepareNode(e):e.nodeType===s?this.prepareCommentNode(e):this.prepareTextNode(e))&&t.appendChild(i)}createToggleElement(){const e=this,t=this.createHTMLElement("span","expand",!1);return this.shouldBeExpanded()&&t.classList.add("expanded"),t.appendChild(this.createHTMLElement("span","on","+")),t.appendChild(this.createHTMLElement("span","off","-")),t.onclick=function(){const t=this.classList.contains("expanded");e.setElementVisibility(this,!t),e.buttonIsKeyDown&&e.setVisibilityForChildElements(this.nextSibling.nextSibling,!t)},t}setElementVisibility(e,t){t?e.classList.contains("expanded")||(e.classList.add("expanded"),this.setVisibility(e.nextSibling.nextSibling,!0)):(e.classList.remove("expanded"),this.setVisibility(e.nextSibling.nextSibling,!1))}setVisibility(e,t){e.style.display=t?"block":"none"}prepareOpeningTag(e){const t=this.createHTMLElement("span","opening-tag");if(t.appendChild(this.createHTMLElement("span","opening","<")),t.appendChild(this.createHTMLElement("span","tag-name",e.tagName)),e.attributes.length){const n=this.createHTMLElement("span","attributes");Array.from(e.attributes).forEach(e=>{const t=this.createHTMLElement("span","attribute");t.appendChild(this.createHTMLElement("span","attribute-name"," "+e.name)),t.appendChild(this.createHTMLElement("span","attribute-equal-char","=")),t.appendChild(this.createHTMLElement("span","attribute-value",`"${e.value}"`)),n.appendChild(t)}),t.appendChild(n)}return t.appendChild(this.createHTMLElement("span","closing",">")),this.appendNumberTag(t),t}prepareClosingTag(e){const t=this.createHTMLElement("span","closing-tag");return t.appendChild(this.createHTMLElement("span","opening","</")),t.appendChild(this.createHTMLElement("span","tag-name",e.tagName)),t.appendChild(this.createHTMLElement("span","closing",">")),this.appendNumberTag(t),t}prepareTextNode(e){if(!t.test(e.textContent))return!1;const n=this.createHTMLElement("span","text-content",e.textContent);return this.appendNumberTag(n),n}prepareCommentNode(e){if(!t.test(e.textContent))return!1;const n=this.createHTMLElement("span","comment-content",`\x3c!--${e.textContent}--\x3e`);return this.appendNumberTag(n),n}prepareNumberTag(e){return this.createHTMLElement("span","line-number",e)}appendNumberTag(e){this.nodeGlobalCounter++,e.prepend(this.prepareNumberTag(this.nodeGlobalCounter))}bindExpandChildNodesEvent(){window.addEventListener("keydown",e=>{e.keyCode===a&&(this.buttonIsKeyDown=!0)}),window.addEventListener("keyup",e=>{e.keyCode===a&&(this.buttonIsKeyDown=!1)})}setVisibilityForChildElements(e,t){this.checkNodeIsNotEmpty(e.childNodes)&&Array.from(e.childNodes).forEach(e=>{if(e.classList.contains("tag-nonempty")&&e.firstChild.nextSibling.nextSibling){const n=e.firstChild;this.setElementVisibility(n,t),this.setVisibilityForChildElements(n.nextSibling.nextSibling,t)}})}initializeSearch(){const e=document.querySelector(`#${this.searchInputId}`);e&&e.addEventListener("input",e=>{this.clearDocumentFromSearchNodes(this.container.firstChild);const t=e.target.value.toLowerCase();this.searchPhrase(t,this.container.firstChild)})}clearDocumentFromSearchNodes(e){if(e)for(let t=e.firstChild;t;t=t.nextSibling)t.nodeType===i?this.clearSpecificTextNode(t):this.clearDocumentFromSearchNodes(t)}clearSpecificTextNode(e){const t=this.findAncestor(e,".text-content, .opening-tag, .closing-tag, .comment-content"),n=t?t.querySelector(".search-phrase"):null;n&&n.remove()}searchPhrase(e,t){if(t)for(let n=t.firstChild;n;n=n.nextSibling)n.nodeType===i?this.searchSpecificTextNode(e,n):n.classList.contains("opening")||n.classList.contains("closing")||this.searchPhrase(e,n)}searchSpecificTextNode(e,t){e&&t.textContent.toLowerCase().includes(e)&&this.findAncestor(t,".text-content, .opening-tag, .closing-tag, .comment-content").prepend(this.prepareSearchNode())}findAncestor(e,t){for(;(e=e.parentElement)&&!(e.matches||e.matchesSelector).call(e,t););return e}prepareSearchNode(){return this.createHTMLElement("span","search-phrase")}}}(window);